box: 
   id: jpusk/playscala
   tag: 0.1

build:
   steps:
    - script:
         code: |
            yum install -y git
            git clone https://github.com/orashio/ScalaPlayTest.git
            cd ScalaPlayTest && sbt compile

push-to-dockerhub:
   steps:
    - internal/docker-push:
        username: $USERNAME
        password: $PASSWORD
        repository: orashio/wercker-test
        working-dir: $WERCKER_ROOT/ScalaPlayTest
        cmd: sbt run

deploy-to-k8s:
   box:
      id: orashio/wercker-test
   steps:
     - kubectl:
           name: create deployment
           server: $KUBERNETES_MASTER
           token: $KUBERNETES_TOKEN
           insecure-skip-tls-verify: true
           command: apply -f $WERCKER_ROOT/kubernetes-deployment.yml
